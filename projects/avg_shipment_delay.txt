SELECT seller_id,
  COUNT(order_id) AS total_orders,
  AVG(DATE_DIFF(order_delivered_customer_date,order_estimated_delivery_date,DAY)) AS avg_delay_per_seller

FROM
`project-re-learning.Data1.combined_data`
WHERE
order_delivered_customer_date IS NOT NULL
AND order_estimated_delivery_date IS NOT NULL
GROUP BY seller_id
ORDER BY avg_delay_per_seller DESC
